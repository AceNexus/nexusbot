# ==========================================
# 應用程式基礎設定
# ==========================================
nexusbot:
  base-url: ${NEXUSBOT_BASE_URL:http://localhost:5001}

# ==========================================
# 伺服器設定
# ==========================================
server:
  port: ${SERVER_PORT:5001}

# ==========================================
# Spring Boot 核心設定
# ==========================================
spring:
  datasource:
    url: jdbc:h2:file:./data/testdb;DB_CLOSE_ON_EXIT=TRUE;AUTO_RECONNECT=TRUE
    driver-class-name: org.h2.Driver
    username: sa
    password:
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
  h2:
    console:
      enabled: true
      path: /h2-console
  cloud:
    config:
      enabled: false  # 本地環境不連接 Config Server

# ==========================================
# 微服務架構設定 (本地環境停用)
# ==========================================
eureka:
  client:
    enabled: false  # 本地環境不使用 Eureka

# ==========================================
# 第三方服務整合 - LINE Bot
# ==========================================
line:
  bot:
    channel-token: ${LINE_CHANNEL_TOKEN:default-token}
    channel-secret: ${LINE_CHANNEL_SECRET:default-secret}
  liff:
    id: ${LINE_LIFF_ID:}

# ==========================================
# 第三方服務整合 - Groq AI
# ==========================================
groq:
  api-key: ${GROQ_API_KEY:default-groq-key}

# ==========================================
# 第三方服務整合 - Email (SMTP)
# ==========================================
email:
  host: smtp.gmail.com
  port: 587
  username: ${EMAIL_USERNAME:default@gmail.com}
  password: ${EMAIL_PASSWORD:default-password}
  from: ${EMAIL_FROM:default@gmail.com}
  from-name: ${EMAIL_FROM_NAME:NexusBot 提醒通知}
  auth: true
  starttls: true
  debug: false

# ==========================================
# 業務邏輯設定 - AI 對話
# ==========================================
ai:
  conversation:
    history-limit: ${AI_HISTORY_LIMIT:15}

# ==========================================
# 第三方服務整合 - OpenStreetMap API
# ==========================================
osm:
  overpass-base-url: ${OSM_OVERPASS_BASE_URL:https://overpass-api.de/api/interpreter}
  timeout-ms: ${OSM_TIMEOUT:15000}
  user-agent: ${OSM_USER_AGENT:NexusBot/1.0}
  carousel-max-items: ${OSM_CAROUSEL_MAX_ITEMS:10}
  toilet-tags:
    - amenity=toilets          # 公共廁所
    - amenity=public_bookcase  # 部分公共設施含廁所
    - building=toilets         # 廁所建築
  facility-tags:
    - amenity=restaurant       # 餐廳
    - amenity=cafe             # 咖啡廳
    - amenity=fast_food        # 速食店
    - shop=convenience         # 便利商店
    - shop=supermarket         # 超市
    - amenity=fuel             # 加油站

# ==========================================
# 第三方服務整合 - FinMind API (台灣金融數據)
# ==========================================
finmind:
  api-token: ${FINMIND_API_TOKEN:}

# ==========================================
# 第三方服務整合 - Fugle API (即時成交明細)
# 免費註冊：https://developer.fugle.tw/
# ==========================================
fugle:
  api-key: ${FUGLE_API_KEY:default-fugle-key}
  websocket-url: wss://api.fugle.tw/marketdata/v1.0/stock/streaming
  rest-base-url: https://api.fugle.tw/marketdata/v1.0
  reconnect-delay: 5000
  max-subscriptions: 5

# ==========================================
# 第三方服務整合 - Yahoo Finance API
# ==========================================
yahoo:
  finance:
    quote-summary-url: https://query1.finance.yahoo.com/v10/finance/quoteSummary
    chart-url: https://query1.finance.yahoo.com/v8/finance/chart
    timeout-seconds: 10
    user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36

# ==========================================
# 安全設定 - 管理員
# ==========================================
admin:
  password-seed: ${ADMIN_PASSWORD_SEED:1103}

# ==========================================
# 日誌設定
# ==========================================
logging:
  level:
    root: INFO
    com.acenexus.tata.nexusbot: INFO
    com.linecorp.bot.client.wire: WARN
    okhttp3: WARN
  pattern:
    console: "[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%level] [%thread] [%logger{36}] - %msg%n"

# ==========================================
# Spring Boot Actuator (健康檢查與監控)
# ==========================================
management:
  endpoints:
    web:
      exposure:
        include: health,info
      base-path: /actuator
  endpoint:
    health:
      enabled: true
      show-details: when-authorized
  health:
    defaults:
      enabled: true
